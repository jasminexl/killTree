<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 设置为userMapper接口方法提供sql语句配置 -->
<mapper namespace="dongxin.flowbilling.channel.mapper.UserMapper">

    <select id="selectUserByUserName" resultType="ChannelUserLogin" parameterType="String">
        SELECT t1.username AS username, t1.password AS password, t1.status AS status, t2.chname AS chname FROM channel_user_login AS t1, channelinfo AS t2 WHERE t1.username = t2.chcode AND t1.username = #{username}
    </select>

    <select id="selectUserByPwd" resultType="ChannelUserLogin" parameterType="Map">
        SELECT t1.username AS username, t1.password AS password, t1.status AS status, t2.chname AS chname FROM channel_user_login AS t1, channelinfo AS t2 WHERE t1.username = t2.chcode AND t1.password=#{pwd}
    </select>

    <insert id="channelLog"  parameterType="Map">
        INSERT INTO
        channel_handle_log(username, channelName, logIP, handle, inserttime)
        VALUES
        ( #{username}, #{channelName}, #{logIP}, #{handle}, NOW())
    </insert>

    <update id="changePWD" parameterType="Map">
        UPDATE
        channel_user_login
        SET
        password = #{pwd}
        WHERE
        username = #{username}
    </update>

</mapper>