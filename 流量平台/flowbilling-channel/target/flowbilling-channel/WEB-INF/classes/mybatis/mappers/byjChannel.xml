<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 设置为IUserDao接口方法提供sql语句配置 -->
<mapper namespace="dongxin.flowbilling.channel.mapper.byjChannelMapper">

    <!--<resultMap id="resultmap" type="User">-->
        <!--<id property="id" column="user_id" />-->
        <!--<result property="username" column="username"/>-->
        <!--<result property="password" column="password"/>-->
    <!--</resultMap>-->

    <select id="selectByChcode" resultType="byjChannel" parameterType="map">
        SELECT
        t1.chcode AS chcode, t3.runmoney AS runmoney, t1.minalarmmoney AS minalarmmoney, t1.maxalarmmoney AS maxalarmmoney, t1.bzjmoney AS bzjmoney, t1.status AS status, t3.inserttime AS inserttime, t2.nameqc AS nameqc, t2.chname AS chname
        FROM
        runlogchannelinfo t1, channelinfo t2,
            (SELECT b1.runmoney AS runmoney, b1.inserttime AS inserttime, b1.chcode AS chcode FROM byjchannelinfolog b1 UNION ALL SELECT b2.runmoney AS runmoney, b2.inserttime AS inserttime, b2.chcode AS chcode FROM ${historyTable} b2) t3
        WHERE
        t1.chcode = t2.chcode AND t1.chcode = t3.chcode AND t1.chcode = #{chcode}
        ORDER BY
        t3.inserttime
        DESC
        LIMIT 0,1
    </select>

</mapper>